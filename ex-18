from Crypto.Signature import DSS
from Crypto.Hash import SHA256
from Crypto.PublicKey import DSA

# Generate DSA key
key = DSA.generate(1024)

# Message
message = b"Same message"

# Hash
h1 = SHA256.new(message)
h2 = SHA256.new(message)

# Sign twice
signer1 = DSS.new(key, 'fips-186-3')
signature1 = signer1.sign(h1)

signer2 = DSS.new(key, 'fips-186-3')
signature2 = signer2.sign(h2)

print("Signature 1:", signature1.hex())
print("Signature 2:", signature2.hex())
print("Signatures match:", signature1 == signature2)
