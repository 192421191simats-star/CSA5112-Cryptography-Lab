from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
import os

BLOCK_SIZE = 16  # AES block size in bytes

def cbc_mac(key, message):
    cipher = AES.new(key, AES.MODE_CBC, iv=bytes(BLOCK_SIZE))  # IV = 0
    padded = pad(message, BLOCK_SIZE)
    ciphertext = cipher.encrypt(padded)
    return ciphertext[-BLOCK_SIZE:]  # Last block is the MAC

def xor_bytes(a, b):
    return bytes(x ^ y for x, y in zip(a, b))

# Setup
key = os.urandom(16)
x = b"Attack at dawn!"  # 16
